@model PhonesAndPeople.Models.IndexViewModel
@using PhonesAndPeople.Helpers
@Styles.Render("~/Content/css")
@{
    ViewBag.Title = "ShowPpl";
}
<table id="olo" class="table">
    <tr>
        <th>
            Фото
        </th>
        <th>
            <a id="sortFname" class="sort" onclick="sortAttr(1)">
                Префикс
            </a> 
        </th>
        <th>
            <a id="sortSname" class="sort" onclick="sortAttr(2)">
                Имя
            </a>
        </th>
        <th>
            <a id="sortLname" class="sort" onclick="sortAttr(3)">
                Фамилия
            </a>
        </th>
        <th>
            <a id="sortDob">
                Дата рождения
            </a>
        </th>
        <th>
            Телефон
        </th>
        <th>
            Почта
        </th>
        <th></th>
    </tr>
    <tbody>
        @foreach (var item in Model.People)
        {
            <tr>
                <td>
                    <a href=@item.PictureBig.ToString() class="highslide" onclick="return hs.expand(this)"> </a>
                    <img id="picture" src=@item.Picture.ToString() alt="Image" />
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.FirstName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.SecondName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.LastName)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Phone)
                </td>
                <td>
                    @Html.DisplayFor(modelItem => item.Email)
                </td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                </td>
            </tr>
        }
    </tbody>
</table>
<br />
<div class="btn-group">
    <input id="btn-prev" type="button" name="prev" value="<<" class="btn btn-default" />
    <input id="btn-this" type="button" name="this" value="@Model.PageInfo.PageNumber" class="btn btn-default btn-primary selected" />
    <input id="btn-last" type="button" name="last" value="@Model.PageInfo.TotalPages" class="btn btn-default" />
    <input id="btn-next" type="button" name="next" value=">>" class="btn btn-default" />
</div>

@Scripts.Render("~/bundles/jquery")
@Scripts.Render("~/Scripts/jquery.unobtrusive-ajax.js")
<script type="text/javascript">
        //alert("Hello");
        $(document).ready(function (event) {
            if (@Model.PageInfo.PageNumber <= 1)
                $("#btn-prev").hide();
            else {
                $("#btn-prev").click(function (event) {
                    $(".btn-group").hide();
                    prevPage();
                });
            }
            $("#btn-last").click(function (event) {
                //alert("Last page click.")
                $(".btn-group").hide();
                lastPage();
            });
            $("#btn-next").click(function (event) {
                //alert("Next page click.")
                $(".btn-group").hide();
                nextPage();
            });
        });
    function prevPage() {
        $.ajax({
            url: "ShowPpl",
            type: "POST",
            data: { "sortOrder": '@ViewBag.LastSortAttr', "fName": $("input.fname").val(), "sName": $("input.sname").val(), "lName": $("input.lname").val(), "page": (@Model.PageInfo.PageNumber - 1) },
            success: function (result) {
                alert("succes handler is called.");
                $('#olo').html(result);
            }
        });
    }
        function nextPage() {
            $.ajax({
                url: "ShowPpl",
                type: "POST",
                data: { "sortOrder": '@ViewBag.LastSortAttr', "fName": $("input.fname").val(), "sName": $("input.sname").val(), "lName": $("input.lname").val(), "page": @Model.PageInfo.PageNumber + 1 },
                success: function (result) {
                    alert("succes handler is called.");
                    $('#olo').html(result);
                }
            });
        }
        function lastPage() {
            $.ajax({
                url: "ShowPpl",
                type: "POST",
                data: { "sortOrder": '@ViewBag.LastSortAttr', "fName": $("input.fname").val(), "sName": $("input.sname").val(), "lName": $("input.lname").val(), "page": @Model.PageInfo.TotalPages },
                success: function (result) {
                    alert("succes handler is called.");
                    $('#olo').html(result);
                }
            });
        }
</script>

